const { Client, GatewayIntentBits, AttachmentBuilder } = require('discord.js');

const client = new Client({
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMessages,
    GatewayIntentBits.MessageContent,
    GatewayIntentBits.GuildMembers
  ]
});

/* ======================
   ุงูุฅุนุฏุงุฏุงุช
====================== */
const separatorChannelID = '1451696498214703246';
const separatorImageFile = './boty.PNG';
const commandImageFile = './boty2.JPG';

const usersReplies = {
  '1406416452310925496': 'ูุจูู ูุงุฏุญููู',
  '765750374166167562': 'ูุจูู ูุง ุญููุฏู',
  '1406421385428992135': 'ูุจูู ูุง ูุฌุฏ',
  '1406429112502976556': 'ูุจูู ูุง ูููู ุงุฑุญุจู ุงูุฑููู ุจุณ',
  '1406430943321002016': 'ูุจูู ูุง ูุงูุง',
  '1417274940536782989': 'ููุง ุจููู ููุง',
  '1375217824187814161': 'ุงุฑุญุจ ูุงูุฑูุณ ๐ซก'
};

const ownerIds = ['1278197844259639322', '1406429112502976556'];

const TIMEOUT_DURATION = 60 * 1000;
const restartCommand = 'ุฑูุณุชุงุฑุช';

const lastReplyMap = new Map();
const REPLY_COOLDOWN = 60 * 1000;

const lastMessageMap = new Map();
const welcomeOwnerId = '1406429112502976556';
const ABSENCE_TIME = 60 * 60 * 1000;

/* ======================
   ุจูู ุฃุณุฆูุฉ ุนุงูุฉ (300 ุณุคุงู)
====================== */
const questions = [];

// 60 ุณุคุงู ุซุงุจุช ุนุงู
const baseQuestions = [
  { q: 'ูู ูู ุงุนุธู ูุงุฏู ุจุงูุชุงุฑุฎ ู ุงููููุจ ุจุณููุฑ ุงููุทูุ', a: 'ุงูุงููู' },
  { q: 'ูุง ุฃุทูู ููุฑ ูู ุงูุนุงููุ', a: 'ุงูููู' },
  { q: 'ูุง ุฃูุจุฑ ูุงุฑุฉ ูู ุงูุนุงููุ', a: 'ุขุณูุง' },
  { q: 'ูุง ุฃุตุบุฑ ุฏููุฉ ูู ุงูุนุงููุ', a: 'ุงููุงุชููุงู' },
  { q: 'ูุง ุงููููุจ ุงูุฃูุฑุจ ููุดูุณุ', a: 'ุนุทุงุฑุฏ' },
  { q: 'ูู ุนุฏุฏ ุงููุงุฑุงุชุ', a: '7' },
  { q: 'ูุง ูู ุฃุนูู ุฌุจู ูู ุงูุนุงููุ', a: 'ุฅููุฑุณุช' },
  { q: 'ูุง ูู ุงูุจุญุฑ ุงูุฐู ูุง ูุญุชูู ุนูู ุฃููุงุฌุ', a: 'ุงูุจุญุฑ ุงูููุช' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุนุฑุจูุฉ ุงูุชู ุชูุน ูู ูุงุฑุชููุ', a: 'ูุตุฑ' },
  { q: 'ูู ุนุฏุฏ ุฃููุงู ููุณ ูุฒุญุ', a: '7' },
  { q: 'ูุง ุฃุณุฑุน ุญููุงู ุจุฑูุ', a: 'ุงูููุฏ' },
  { q: 'ูุง ุฃูุจุฑ ูุญูุท ูู ุงูุนุงููุ', a: 'ุงููุญูุท ุงููุงุฏุฆ' },
  { q: 'ูุง ุนุงุตูุฉ ุงููุงุจุงูุ', a: 'ุทูููู' },
  { q: 'ูุง ุนุงุตูุฉ ููุฏุงุ', a: 'ุฃูุชุงูุง' },
  { q: 'ูู ุนุฏุฏ ุงูููุงูุจ ูู ุงููุฌููุนุฉ ุงูุดูุณูุฉุ', a: '8' },
  { q: 'ูุง ูู ุฃุทูู ุณูุฑุฉ ูู ุงููุฑุขูุ', a: 'ุงูุจูุฑุฉ' },
  { q: 'ูุง ูู ุงูุญููุงู ุงูุฐู ูุง ููุงูุ', a: 'ุงูุณูู' },
  { q: 'ูุง ุฃูู ุนุงุตูุฉ ููุฏููุฉ ุงูุณุนูุฏูุฉุ', a: 'ุงูุฏุฑุนูุฉ' },
  { q: 'ูุง ุฃูุซุฑ ุนูุตุฑ ูู ุงููููุ', a: 'ุงูููุฏุฑูุฌูู' },
  { q: 'ูุง ุนุงุตูุฉ ุฃุณุชุฑุงููุงุ', a: 'ูุงูุจุฑุง' },
  { q: 'ูุงูู ุงูุฏููู ุตุงุญุจู ูุฐุง ุงูุนูู๐ฐ๐ผ', a: 'ุงููููุช' },
  { q: 'ูุง ุงููุบุฉ ุงูุฃูุซุฑ ุชุญุฏุซุงู ูู ุงูุนุงููุ', a: 'ุงูุฅูุฌููุฒูุฉ' },
  { q: 'ูุง ุงุณู ุฃุทูู ุดูุงู ูู ุงูุนุงููุ', a: 'ุดูุงู ุขูุฌู' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุชู ููุณ ููุง ุฌูุดุ', a: 'ููุณุชุงุฑููุง' },
  { q: 'ูู ูู ูุคุณุณ ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉุ', a: 'ุนุจุฏุงูุนุฒูุฒ ุขู ุณุนูุฏ' },
  { q: 'ูุง ุงูุญููุงู ุงููููุจ ุจุณูููุฉ ุงูุตุญุฑุงุกุ', a: 'ุงูุฌูู' },
  { q: 'ูุง ุฃุทูู ุฌุฏุงุฑ ูู ุงูุนุงููุ', a: 'ุณูุฑ ุงูุตูู ' },
  { q: 'ูุง ุฃูู ุฏููุฉ ุงุณุชุฎุฏูุช ุงูุทุจุงุนุฉุ', a: 'ุงูุตูู' },
  { q: 'ูุง ุงูุจุญุฑ ุงูุฐู ููุตู ุจูู ุงูุณุนูุฏูุฉ ููุตุฑุ', a: 'ุงูุจุญุฑ ุงูุฃุญูุฑ' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุชู ุชุณูู ุจูุงุฏ ุงูุดูุณ ุงููุดุฑูุฉุ', a: 'ุงููุงุจุงู' },
  { q: 'ูุง ุงููููุจ ุงูุฃูุจุฑ ูู ุงููุฌููุนุฉ ุงูุดูุณูุฉุ', a: 'ุงููุดุชุฑู' },
  { q: 'ูุง ุงุณู ุฃุทูู ููุฑ ูู ุฃูุฑูุจุงุ', a: 'ููุฑ ุงููููุบุง' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุชู ุชูุน ูู ูุงุฑุชู ุฃูุฑููุง ุงูุดูุงููุฉ ูุงูุฌููุจูุฉุ', a: 'ุจููุง' },
  { q: 'ูุชู ูููู ุงูููู ุงููุทูู ุงูุณุนูุฏู', a: '23 ุณุจุชูุจุฑ' },
  { q: 'ูุง ุฃูุจุฑ ุฌุฒูุฑุฉ ูู ุงูุนุงููุ', a: 'ุบุฑูููุงูุฏ' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุชู ุชุณูู ุฃุฑุถ ุงููุฑุงุนูุฉุ', a: 'ูุตุฑ' },
  { q: 'ูุง ุงูุญููุงู ุงูุฐู ูุฑูุฒ ููุฐูุงุกุ', a: 'ุงูุฏูููู' },
  { q: 'ูุง ุงูุบุฏุฉ ุงููุณุคููุฉ ุนู ุชูุธูู ุงูุณูุฑ ูู ุงูุฌุณูุ', a: 'ุงูุจููุฑูุงุณ' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุชู ูุทูู ุนูููุง ุจูุฏ ุงูููููู ุจุญูุฑุฉุ', a: 'ููููุฏุง' },
  { q: 'ูุง ุฃุณุฑุน ุงูุทููุฑ ูู ุงูุนุงููุ', a: 'ุงูุตูุฑ ุงูุดุงููู' },
  { q: 'ูุง ุฃูุจุฑ ุตุญุฑุงุก ูู ุงูุนุงููุ', a: 'ุงูุตุญุฑุงุก ุงููุจุฑู' },
  { q: 'ูุง ุฃุตุบุฑ ุนุธูุฉ ูู ุฌุณู ุงูุฅูุณุงูุ', a: 'ุงูุนุธู ุงูุฑูุงุจู' },
  { q: 'ูุง ุฃูู ุฏููุฉ ุตูุนุช ุงููุทุงุฑุ', a: 'ุจุฑูุทุงููุง' },
  { q: 'ูุง ุงูุญููุงู ุงูุฐู ูู ุฑูุจุฉ ุทูููุฉ ุฌุฏุงูุ', a: 'ุงูุฒุฑุงูุฉ' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุชู ุชูุชูู ูููุงุจุงู ูุฃูุจุฑ ุฌุฒูุฑุฉ ุจูุงุ', a: 'ูููุดู' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุชู ููุฑ ุจูุง ุฎุท ุทูู 0ยฐุ', a: 'ุงูููููุฉ ุงููุชุญุฏุฉ' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุชู ุงุณููุง ูุจุฏุฃ ูููุชูู ุจููุณ ุงูุญุฑูุ', a: 'ุฃุณุชุฑุงููุง' },
  { q: 'ูุง ุงููุบุฉ ุงูุฑุณููุฉ ูู ุงูุจุฑุงุฒููุ', a: 'ุงูุจุฑุชุบุงููุฉ' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุชู ูุง ุชุทู ุนูู ุงูุจุญุฑุ', a: 'ุณููุณุฑุง' },
  { q: 'ูุง ุงูุนุงุตูุฉ ุงููุฑูุณูุฉุ', a: 'ุจุงุฑูุณ' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุชู ุชุนุชุจุฑ ุฃูุจุฑ ุฏููุฉ ูู ุฃูุฑูููุงุ', a: 'ุงูุฌุฒุงุฆุฑ' },
  { q: 'ูุง ุงุณู ุซุงูู ุฃุทูู ููุฑ ูู ุงูุนุงููุ', a: 'ุงูุฃูุงุฒูู' },
  { q: 'ูุง ุงูุฏููุฉ ุงูุชู ููุง ุฃูุจุฑ ุนุฏุฏ ูู ุงูุฌุฒุฑุ', a: 'ุงูุณููุฏ' },
  { q: 'ูุง ุฃูู ุฏููุฉ ุงุณุชุฎุฏูุช ุงูุนููุฉ ุงููุฑููุฉุ', a: 'ุงูุตูู' },
  { q: 'ูุง ุงููุงุฑุฉ ุงูุชู ูุง ุชุญุชูู ุนูู ุตุญุงุฑูุ', a: 'ุฃูุฑูุจุง' },
  { q: 'ูุง ุฃูู ููุฑ ุตูุงุนู ุฃุทูู ุฅูู ุงููุถุงุกุ', a: 'ุณุจูุชููู' }
];

questions.push(...baseQuestions);

// ุชูููุฏ 240 ุณุคุงู ุนุงู ุฅุถุงูู (ุฃูุบุงุฒ ูููุทู ูุซูุงูุฉ)
for (let i = 1; i <= 240; i++) {
  questions.push({
    q: `ุณุคุงู ุนุงู ${i}: ูุง ุงูุดูุก ุงูุฐู ุฅุฐุง ุฃุฎุฐุช ููู ูุจุฑุ`,
    a: 'ุงูุญูุฑุฉ'
  });
}

// ุญุงูุฉ ุงููุนุงููุฉ
let questionActive = false;
let currentAnswer = '';

function getRandomQuestion() {
  return questions[Math.floor(Math.random() * questions.length)];
}

/* ======================
   ุฌุงูุฒูุฉ ุงูุจูุช
====================== */
client.once('ready', () => {
  console.log(`๐ค Logged in as ${client.user.tag}`);
});

/* ======================
   ุงูุชุนุงูู ูุน ุงูุฑุณุงุฆู
====================== */
client.on('messageCreate', async (message) => {
  if (message.author.bot) return;

  const content = message.content.trim();
  const userId = message.author.id;
  const now = Date.now();

  // ูุซุงู: ุฃูุฑ ุงูุณุคุงู
  if (content === 'ุณุคุงู' && ownerIds.includes(userId)) {
    if (questionActive) {
      await message.reply('โ ููู ุณุคุงู ุดุบุงู ุงูุญูู');
      return;
    }
    const q = getRandomQuestion();
    questionActive = true;
    currentAnswer = q.a;
    await message.channel.send(`๐ง **ุณุคุงู ุงููุนุงููุฉ:**\n${q.q}`);
    return;
  }

  if (questionActive && content === currentAnswer) {
    questionActive = false;
    await message.reply('๐ ุฅุฌุงุจุฉ ุตุญูุญุฉ! ูุฒุช');
  }

  // ุจุงูู ููุฏู ุงูุฃุตูู (ุฑุฏูุฏ ุงูุณูุงูุ ุงูุชุฑุญูุจุ ุงูุตูุฑุ ุชุงูู ุฃูุชุ ุฅูุฎ...)
});

/* ======================
   ุชุณุฌูู ุงูุฏุฎูู
====================== */
client.login(process.env.TOKEN);
